<!DOCTYPE HTML>
<html>

<head>
  <script src="common/common.js"></script>
  <script src="config/config.js"></script>
  <script src="node_modules/vue/dist/vue.min.js"></script>
  <script src="node_modules/vue-resource/dist/vue-resource.min.js"></script>
  <link rel="stylesheet" href="node_modules/element-ui/lib/theme-chalk/index.css">
  <script src="node_modules/element-ui/lib/index.js"></script>
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="alternate" media="handheld" />
  <!-- end 云适配 -->
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>内容运营-立方网-拉勾网-最专业的互联网招聘平台</title>
  <meta name="baidu-site-verification" content="QIQ6KC1oZ6" />
  <link rel="Shortcut Icon" href="style/images/favicon.ico">
  <link rel="stylesheet" type="text/css" href="style/css/style.css" />
  <link rel="stylesheet" type="text/css" href="style/css/external.min.css" />
  <link rel="stylesheet" type="text/css" href="style/css/popup.css" />
  <script src="node_modules/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="style/js/jquery.lib.min.js"></script>
  <script src="style/js/jquery-hbzx.js" type="text/javascript"></script>
  <!--[if lte IE 8]>
    <script type="text/javascript" src="style/js/excanvas.js"></script>
<![endif]-->
  <style>
    #container .job_company dt .confirm {
      margin-left: 20px;
    }

    .deliveryTip .el-dialog__body {
      text-align: center;
      font-size: 18px;
    }
  </style>
</head>

<body>
  <div id="body" v-cloak>
    <div id="header">
      <div class="wrapper">
        <a class="logo" href="index.html">
          <img width="229" height="43" alt="拉勾招聘-专注互联网招聘" src="style/images/logo.png">
        </a>
        <ul id="navheader" class="reset">
          <li><a href="index.html">首页</a></li>
          <li><a href="companylist.html">公司</a></li>
          <li><a target="_blank" href="toForum.html">论坛</a></li>
          <li><a rel="nofollow" href="jianli.html">我的简历</a></li>
        </ul>
        <ul class="loginTop" v-if="!logined">
          <li><a href="login.html" rel="nofollow">登录</a></li>
          <li>|</li>
          <li><a href="register.html" rel="nofollow">注册</a></li>
        </ul>
        <dl class="collapsible_menu" v-else-if="userInfo.type===0">
          <dt>
            <span>{{userInfo.name}}</span>
          </dt>
          <dd><a rel="nofollow" href="jianli.html">我的简历</a></dd>
          <dd><a href="collections.html">我收藏的职位</a></dd>
          <dd class="btm"><a href="subscribe.html">我的订阅</a></dd>
          <dd><a href="accountBind.html">帐号设置</a></dd>
          <dd class="logout"><a rel="nofollow" href="login.html">退出</a></dd>
        </dl>
        <dl class="collapsible_menu" v-elseif="userInfo.type===1">
          <dt>
            <span>{{userInfo.easyname}}</span>
            <i></i>
          </dt>
          <dd><a href="positions.html">我发布的职位</a></dd>
          <dd><a href="positions.html">我收到的简历</a></dd>
          <dd class="btm"><a href="myhome.html">我的公司主页</a></dd>
          <dd><a href="accountBind.html">帐号设置</a></dd>
          <dd class="logout"><a rel="nofollow" href="login.html">退出</a></dd>
        </dl>
        <div class="dn" id="noticeTip">
          <span class="bot"></span>
          <span class="top"></span>
          <a target="_blank" href="delivery.html"><strong>0</strong>条新投递反馈</a>
          <a class="closeNT" href="javascript:;"></a>
        </div>
      </div>
    </div>
    <!-- end #header -->
    <el-dialog title="提示" :visible.sync="dialogVisible" width="30%">
      <span>您的个人信息不完整，是否完善？</span>
      <span slot="footer" class="dialog-footer">
        <el-button @click="dialogVisible = false">取 消</el-button>
        <el-button type="primary" class="ele-button" @click="addUserInfo">确 定</el-button>
      </span>
    </el-dialog>
    <el-dialog class="deliveryTip" title="提示" center :visible.sync="dialogDelivery" width="30%">
      <span class="deliveryTip">是否投递？</span>
      <span slot="footer" class="dialog-footer">
        <el-button @click="dialogDelivery = false">取 消</el-button>
        <el-button type="primary" class="ele-button" @click="delivery">确 定</el-button>
      </span>
    </el-dialog>
    <div id="container">
      <div class="clearfix">
        <div class="content_l">
          <dl class="job_detail">
            <dt>
              <h1 title="web前端开发">
                <em></em>
                <div>{{jobData.easyname}}招聘</div>
                {{jobData.jobName}}
              </h1>
              <div class="jd_collection" :class="{'collected':collect}" @click="collectJob" id="jobCollection"></div>
            </dt>
            <dd class="job_request">
              <span class="red">{{jobData.min_salary}}k-{{jobData.max_salary}}k</span>
              <span>{{jobData.city}}</span>
              <span>{{getExperience(jobData.experience)}}</span>
              <span> {{getEdu(jobData.education)}}</span>
              <span>{{getNature(jobData.nature)}}</span><br>
              职位诱惑：{{jobData.advantage}}
              <div>发布时间：{{jobData.updatetime}}发布</div>
            </dd>
            <dd class="job_bt">
              <h3 class="description">职位描述</h3>
              <div v-html="jobData.describe"></div>
            </dd>
            <!-- 用户是否激活 0-否；1-是 -->
            <dd class="resume resume_web">
              <div style="width:400px;">
                <span style="line-height: 46px;">
                  当前简历：
                  <a title="jason的简历" target="_blank" href="./jianli.html">
                    <strong>在线简历：{{userInfo.name}}的简历</strong>
                  </a>
                </span>
              </div>
              <!-- <a title="设置默认投递简历" @click="selectResume" class="inline fl cboxElement">重新设置</a> -->
            </dd>
            <dd>
              <a title="投个简历" class="btn fr btn_apply" @click="openDelivery" href="#">投个简历</a>
            </dd>
          </dl>
        </div>
        <div class="content_r">
          <dl class="job_company">
            <dt>
              <a href="h/c/683.html" target="_blank">
                <img class="b2" :src="jobData.logo" width="80" height="80" :alt="jobData.companyName" />
                <div>
                  <h2 class="fl">
                    {{jobData.easyname}}
                    <img width="15" @mouseenter="changeConfirm" @mouseleave="changeConfirm"
                      v-show="jobData.confirmStatus===1" height="19" alt="拉勾认证企业" src="style/images/valid.png">
                    <span class="confirm" v-show="confirm && jobData.confirmStatus===1">拉勾认证企业</span>
                    <img width="15" @mouseenter="changeConfirm" @mouseleave="changeConfirm"
                      v-show="jobData.confirmStatus===0" height="19" alt="拉勾未认证企业" src="style/css/img/unvalid.png">
                    <span class="confirm" v-show="confirm && jobData.confirmStatus===0">拉勾未认证企业</span>
                  </h2>
                </div>
              </a>
            </dt>
            <dd>
              <ul class="c_feature reset">
                <li><span>领域</span>{{jobData.field}}</li>
                <li><span>规模</span>{{getScale(jobData.scale)}}</li>
                <li>
                  <span>主页</span>
                  <a :href="jobData.url" target="_blank" :title="jobData.url" rel="nofollow">{{jobData.url}}</a>
                </li>
              </ul>
              <h4>发展阶段</h4>
              <ul class="c_feature reset">
                <li><span>目前阶段</span>{{getDevStage(jobData.dev_stage)}}</li>
                <!-- <li><span>投资机构</span> IDG(A轮)，腾讯(A轮)</li> -->
              </ul>
              <h4>工作地址</h4>
              <div>{{jobData.position}}</div>
              <div id="smallmap"></div>
              <a href="javascript:;" id="mapPreview">查看完整地图</a>
            </dd>
          </dl>
          <a href="h/subject/s_zhouyou.html?utm_source=BD__lagou&utm_medium=&utm_campaign=zhouyou" target="_blank"
            class="eventAd">
            <img src="style/images/zhouyou.jpg" width="280" height="135" />
          </a>
        </div>
      </div>
      <div id="tipOverlay"></div>
      <div style="display:none;">
        <!--地图弹窗-->
        <div id="baiduMap" class="popup">
          <div id="allmap"></div>
        </div>
        <!--/#baiduMap-->
      </div>
      <script type="text/javascript"
        src="http://api.map.baidu.com/api?v=2.0&ak=3d6a9f4b807441569414b01eecc20959"></script>
      <a id="backtop" title="回到顶部" rel="nofollow"></a>
    </div>
    <!-- end #container -->
  </div>
  <!-- end #body -->
  <div id="footer">
    <div class="wrapper">
      <a href="h/about.html" target="_blank" rel="nofollow">联系我们</a>
      <a href="h/af/zhaopin.html" target="_blank">互联网公司导航</a>
      <a href="http://e.weibo.com/lagou720" target="_blank" rel="nofollow">拉勾微博</a>
      <a class="footer_qr" href="javascript:void(0)" rel="nofollow">拉勾微信<i></i></a>
      <div class="copyright">&copy;2013-2014 Lagou <a target="_blank"
          href="http://www.miitbeian.gov.cn/state/outPortal/loginPortal.action">京ICP备14023790号-2</a></div>
    </div>
  </div>
  <script>
    var app = new Vue({
      el: '#body',
      data: {
        collect:false,
        confirm: false,
        jobId: '',
        jobData: {},
        userInfo: {},
        logined: false,
        dialogVisible: false,
        dialogDelivery: false
      },
      methods: {
        openDelivery() {
          this.dialogDelivery = true
        },
        checkCollect(){
          this.$http.post(window.lagou+'/job/index/checkCollect',{jobId:this.jobId},{credentials:true,emulateJSON:true}).then((res)=>{
            if(res.body.id!==''){
              this.collect=true
            }
          }).catch((err)=>{})
        },
        collectJob(){
          if(this.collect){
            return
          }
          this.$http.post(window.lagou+'/job/index/collect',{jobId:this.jobId},{credentials:true,emulateJSON:true}).then((res)=>{
            if(res.body==='1'){
              this.$message({
                type:'success',
                message:'收藏成功',
                duration:1000,
                onClose:()=>{

                }
              })
            }
          }).catch((err)=>{

          })
        },
        changeConfirm() {
          this.confirm = !this.confirm
        },
        delivery() {
          this.$http.post(window.lagou + '/jianli/index/delivery', { jobId: this.jobId }, { credentials: true, emulateJSON: true }).then((res) => {
            if (res.body === '1') {
              this.dialogDelivery = false
              this.$message({
                type: 'success',
                message: '投递成功，请静候佳音！',
                duration: 1000,
              })
            } else if (res.body === '2') {
              this.dialogDelivery = false
              this.$message({
                type:'success',
                message:'请勿重复投递',
                duration:1500
              })
            }
          }).catch((err) => { })
        },
        mapInit() {
          //百度地图API功能
          var sMap = new BMap.Map("smallmap");
          sMap.enableScrollWheelZoom(true);
          if ($('#positionLat').val() && $('#positionLng').val()) {
            var sPoint = new BMap.Point($('#positionLng').val(), $('#positionLat').val());
            sMap.centerAndZoom(sPoint, 12);
            // 将标注添加到地图中
            sMap.addOverlay(new BMap.Marker(sPoint));
          } else {
            // 创建地址解析器实例
            var sMyGeo = new BMap.Geocoder();
            // 将地址解析结果显示在地图上,并调整地图视野
            var address = this.jobData.position;
            var city = this.jobData.city;
            sMyGeo.getPoint(address, function (sPoint) {
              if (sPoint) {
                sMap.centerAndZoom(sPoint, 16);
                sMap.addOverlay(new BMap.Marker(sPoint));
              }
            }, city);
          }
          /*弹窗大地图*/
          var map = new BMap.Map("allmap");
          map.addControl(new BMap.NavigationControl());
          map.addControl(new BMap.MapTypeControl());
          map.addControl(new BMap.OverviewMapControl());
          map.enableScrollWheelZoom(true);
          // 创建地址解析器实例
          var gc = new BMap.Geocoder();
          $('#mapPreview').bind('click', () => {
            $.colorbox({ inline: true, href: "#baiduMap", title: "公司地址" });
            var address = this.jobData.position;
            var city = this.jobData.city;
            map.setCurrentCity(city);
            map.setZoom(12);
            gc.getPoint(address, function (point) {
              if (point) {
                var p = new BMap.Point(point.lng, point.lat);
                var marker = new BMap.Marker(p);  // 创建标注
                map.addOverlay(marker);              // 将标注添加到地图中
                setTimeout(function () {
                  map.centerAndZoom(p, 15);
                }, 1000);
                map.setZoom(14);
                var sContent =
                  "<h4 style='margin:0 0 5px 0;padding:0.2em 0'>" + city + "</h4>" +
                  "<p style='margin:0;line-height:1.5;font-size:13px;text-indent:2em'>" + address + "</p>" +
                  "</div>";
                var infoWindow = new BMap.InfoWindow(sContent);  // 创建信息窗口对象
                //图片加载完毕重绘infowindow
                marker.openInfoWindow(infoWindow);
              }
            }, city);
          });
        },
        checkCookie() {
          $.ajax({
            url: window.lagou + '/login/index/checkCookie',
            xhrFields: {
              withCredentials: "true"
            },
            success: (res) => {
              // 普通用户
              if (res.type === 0) {
                this.userInfo = res
                this.userInfo.name = res.name ? res.name : '游客'
                this.dialogVisible = res.name === '' ? true : false
                this.logined = true
              } else if (res.type === 1) {
                // hr用户
                this.userInfo.easyname = res.easyname ? res.easyname : '游客'
                this.logined = true
              } else {
                // 登录失败
                window.location.href = "./login.html"
              }
            },
            error: (res) => {
              window.location.href = "./login.html"
            }
          })
        },
        getData() {
          $.ajax({
            url: window.lagou + '/job/index/getJobAndComById',
            data: { jobId: this.jobId },
            dataType: 'json',
            method: 'post',
            xhrFields: {
              withCredentials: true
            },
            success: (res) => {
              this.jobData = res
              this.mapInit()
            },
            error: (err) => {

            }
          })
        },
        addUserInfo() {
          this.dialogVisible = false
          $.ajax({
            url: window.lagou + '/jianli/index/addUserInfo',
            xhrFields: {
              withCrednetials: true
            },
            success: (res) => {
              console.log(res)
            },
            error: (res) => {

            }
          })
          window.location.href = './jianli.html'
        },
        addViewTime() {
          $.ajax({
            url: window.lagou + '/job/index/addViewTime',
            method: 'post',
            data: { jobId: this.jobId },
            dataType: 'json',
            xhrFields: {
              withCredentials: true
            },
            success: (res) => { },
            error: (err) => { }
          })
        }
      },
      created() {
        this.jobId = getParams().jobId
        this.checkCookie()
        this.getData()
        this.addViewTime()
        this.checkCollect()
      }
    })
  </script>
</body>

</html>