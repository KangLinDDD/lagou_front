<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script src="node_modules/jquery/dist/jquery.min.js"></script>
  <!-- <script type="text/javascript" src="style/js/jquery.1.10.1.min.js"></script> -->
  <!-- <script src="style/js/jquery.lib.min.js" type="text/javascript"></script> -->
  <script src="node_modules/jquery-validation/dist/jquery.validate.min.js"></script>
  <script src="node_modules/vue/dist/vue.min.js"></script>
  <title>Document</title>
</head>

<body>
  <div id="body">
    <form id="profileForm" action="">
      <table>
        <tbody>
          <tr>
            <td valign="top">
              <span class="redstar">*</span>
            </td>
            <td>
              <input type="text" placeholder="姓名" v-model="userInfo.name" value="" name="names" id="names">
            </td>
          </tr>
          <tr>
            <td></td>
            <td colspan="3">
              <input type="submit" @click="saveUserInfo" value="保 存" class="btn_profile_save">
              <a class="btn_profile_cancel" @click="cancleClick" href="javascript:;">取 消</a>
            </td>
          </tr>
        </tbody>
      </table>
    </form>
    <input type="file" value="" title="支持jpg、jpeg、gif、png格式，文件小于5M"
      onchange="img_check(this,window.lagou + '/jianli/index/basicInfo','headPic');" name="headPic" id="headPic"
      class="myfiles">
  </div>

  <script>
    var app = new Vue({
      el: '#body',
      data: {
        userInfo: {
          name: "aaa"
        },
        temInfo:{
          name: ''
        }
      },
      methods: {
        saveUserInfo() {
          this.temInfo =  this.userInfo
          console.log(this.temInfo)
          $("#profileForm").validate({
            rules: {
              names: "required"
            },
            messages: {
              names: "请输入您的名字"
            },
            submitHandler: function (form) {
              alert("提交事件!");
              $.ajax({
                url: 'tp5.com/login/index/checkCookie',
                xhrFields: {
                  withCredentials: true
                },
                success: (res) => {
                  console.log(res)
                },
                error: (res) => {

                }
              })
            }
          })
        },
        cancleClick(){
          console.log(this.temInfo)
          this.userInfo =  this.temInfo
        }
      },
      mounted() {

      },
      created() {

      }
    })
  </script>
  <script>
    function img_check(a, b, c) {
      alert(b)
      var a = $("#" + c);
      this.AllowExt = ".jpg,.gif,.jpeg,.png,.pjpeg",
        this.FileExt = a.val().substr(a.val().lastIndexOf(".")).toLowerCase(),
        0 != this.AllowExt && -1 == this.AllowExt.indexOf(this.FileExt) ? errorTips("只支持jpg、gif、png、jpeg格式，请重新上传", "上传头像") : ($("#" + c + "_error").text("").hide(),
          $.ajaxFileUpload({
            url: b,
            data: { headPic: a.val() },
            dataType: "json",
            method: 'post',
            success: function (a) {
              alert(a)
              if (a.success) {
                var b = a.content;
                $("#portraitShow img").attr("src", ctx + "/" + b),
                  $("#basicInfo .basicShow img").attr("src", ctx + "/" + b),
                  $("#portraitNo").hide(),
                  $("#portraitShow").show()
              } else errorTips("上传失败，请重新上传", "上传头像")
            },
            error: function () {
              errorTips("上传失败，请重新上传", "上传头像")
            }
          }))
    }
  </script>
</body>

</html>